"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkServerSecurity = void 0;
function checkServerSecurity(node) {
    if (node.type === 'CallExpression' && node.callee.name === 'session') {
        const cookieProperty = node.arguments[0].properties.find((property) => property.key.name === 'cookie');
        if (cookieProperty) {
            const flags = cookieProperty.value.properties;
            const httpOnlyFlag = flags.find((flag) => flag.key.name === 'httpOnly');
            const secureFlag = flags.find((flag) => flag.key.name === 'secure');
            const sameSiteFlag = flags.find((flag) => flag.key.name === 'sameSite');
            if (httpOnlyFlag && httpOnlyFlag.value.value === true) {
                console.log('httpOnly flag is set correctly.'.green);
            }
            else {
                console.log('httpOnly flag is not set correctly.'.red);
            }
            if (secureFlag && secureFlag.value.value === true) {
                console.log('secure flag is set correctly.'.green);
            }
            else {
                console.log('secure flag is not set correctly.'.red);
            }
            if (sameSiteFlag && sameSiteFlag.value.value === true) {
                console.log('sameSite flag is set correctly.'.green);
            }
            else {
                console.log('sameSite flag is not set correctly.'.red);
            }
        }
    }
    // Recurse through child nodes
    if (node.body) {
        checkServerSecurity(node.body);
    }
}
exports.checkServerSecurity = checkServerSecurity;
