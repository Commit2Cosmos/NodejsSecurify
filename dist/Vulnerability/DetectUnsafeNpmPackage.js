"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkVulnerablePackages = void 0;
const child_process_1 = require("child_process");
function checkVulnerablePackages() {
    const auditCommand = 'npm audit --json';
    (0, child_process_1.exec)(auditCommand, (error, stdout, stderr) => {
        if (error) {
            console.error(`Error executing npm audit: ${error.message}`);
            return;
        }
        const auditReport = JSON.parse(stdout);
        const vulnerablePackages = auditReport.vulnerabilities;
        if (vulnerablePackages && Object.keys(vulnerablePackages).length > 0) {
            console.log('Vulnerable packages found:'.red);
            for (const packageName in vulnerablePackages) {
                console.log(`Package: ${packageName}`);
                console.log(`Severity: ${vulnerablePackages[packageName].severity}`);
                console.log(`Vulnerable Versions: ${vulnerablePackages[packageName].via}`);
                console.log('---');
            }
        }
        else {
            console.log('No vulnerable packages found.'.green);
        }
    });
}
exports.checkVulnerablePackages = checkVulnerablePackages;
