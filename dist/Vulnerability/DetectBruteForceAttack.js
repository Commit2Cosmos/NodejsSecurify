"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.detectBruteForce = void 0;
const natural_1 = require("natural");
// Example dataset (Replace this with your actual dataset)
const dataset = [
    {
        'code': 'function add(a, b) { return a + b; }',
        'label': 0,
    },
    {
        'code': 'var username = "admin"; var password = "admin123";',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "password") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "1q2w3e4r") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "admin" && password === "pa$$w0rd") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (isValidUser(username) && isValidPassword(password)) { return true; } else { return false; } }',
        'label': 0,
    },
    {
        'code': 'const users = ["user1", "user2", "user3"]; function login(username, password) { if (users.includes(username) && password === "password") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "admin123" || password === "password" || password === "qwerty") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (isValidCredentials(username, password)) { return true; } else { return false; } }',
        'label': 0,
    },
    {
        'code': 'function login(username, password) { if (username === "admin" && password === "admin@123") { return true; } else { return false; } }',
        'label': 0,
    },
    {
        'code': 'function add(a, b) { return a + b; }',
        'label': 0,
    },
    {
        'code': 'var username = "admin"; var password = "admin123";',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "password") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "1q2w3e4r") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "admin" && password === "pa$$w0rd") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (isValidUser(username) && isValidPassword(password)) { return true; } else { return false; } }',
        'label': 0,
    },
    {
        'code': 'const users = ["user1", "user2", "user3"]; function login(username, password) { if (users.includes(username) && password === "password") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "admin123" || password === "password" || password === "qwerty") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (isValidCredentials(username, password)) { return true; } else { return false; } }',
        'label': 0,
    },
    {
        'code': 'function login(username, password) { if (username === "admin" && password === "admin@123") { return true; } else { return false; } }',
        'label': 0,
    },
    {
        'code': 'function login(username, password) { if (password === "123456") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "john" && password === "john123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "letmein") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "qwerty123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "abcdef") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "password123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "default") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "admin" && password === "admin12345") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "admin@321") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "abcdefg") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "1234") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "root" && password === "root123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "admin@1234") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "test" && password === "test123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "user" && password === "userpass") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "12345") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "secure" && password === "secure@123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "password1") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "user" && password === "password") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "admin@12345") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "webadmin" && password === "webadmin123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "test123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "12345678") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "user123" && password === "user123pass") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "iloveyou") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "abcdef123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "qwertyuiop") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "superuser" && password === "superpass123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "abcdef@123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "testuser" && password === "testuserpass") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "111111") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "john_doe" && password === "john_doe@123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "qwertyuiop123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "abcdef!@#") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "password@123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "user123" && password === "user123@pass") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "1234abcd") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "987654321") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "user123" && password === "user1234@pass") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "password@1234") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "admin" && password === "admin123456") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "admin@!@#123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "abcd1234") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "user" && password === "pass12345") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "asdfghjkl") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "12345abcd") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "pass@word123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "user" && password === "user123456") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "password@!@#123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "jsmith" && password === "johnsmith") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "1234567890") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "q1w2e3r4t5y6u7") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "1qaz2wsx3edc") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "jsmith" && password === "johnsmith123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "qwerty12345") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "iloveyou123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "123456789") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "testuser123" && password === "testuser123pass") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "testtest") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "jsmith" && password === "smith123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "qwert12345") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "testuser1" && password === "testuser1234") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "abcdefg123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "pass12345") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "testuser123" && password === "testuserpass123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "testtest123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "jsmith" && password === "smith1234") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "qwert123456") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "testuser1" && password === "testuser12345") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "abcdefg1234") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "pass123456") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "testuser123" && password === "testuserpass1234") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "testtest1234") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "jsmith" && password === "smith12345") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "qwert1234567") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "testuser1" && password === "testuser123456") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "abcdefg12345") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "pass1234567") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "testuser123" && password === "testuserpass12345") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function add(a, b) { return a + b; }',
        'label': 0,
    },
    {
        'code': 'var a = 5; var b = 10; var sum = a + b;',
        'label': 0,
    },
    {
        'code': 'function greet(name) { return "Hello, " + name + "!"; }',
        'label': 0,
    },
    {
        'code': 'var x = 3; var y = 7; var result = x * y;',
        'label': 0,
    },
    {
        'code': 'function multiply(a, b) { return a * b; }',
        'label': 0,
    },
    {
        'code': 'var pi = 3.14159; var radius = 5; var area = pi * radius * radius;',
        'label': 0,
    },
    {
        'code': 'function divide(a, b) { return a / b; }',
        'label': 0,
    },
    {
        'code': 'var side = 4; var area = side * side;',
        'label': 0,
    },
    {
        'code': 'function power(base, exponent) { return Math.pow(base, exponent); }',
        'label': 0,
    },
    {
        'code': 'var num1 = 10; var num2 = 20; var result = num1 + num2;',
        'label': 0,
    },
    {
        'code': 'function subtract(a, b) { return a - b; }',
        'label': 0,
    },
    {
        'code': 'var length = 6; var breadth = 8; var area = length * breadth;',
        'label': 0,
    },
    {
        'code': 'function average(a, b, c) { return (a + b + c) / 3; }',
        'label': 0,
    },
    {
        'code': 'var base = 2; var exponent = 5; var result = Math.pow(base, exponent);',
        'label': 0,
    },
    {
        'code': 'function isEven(num) { return num % 2 === 0; }',
        'label': 0,
    },
    {
        'code': 'var radius = 3; var circumference = 2 * Math.PI * radius;',
        'label': 0,
    },
    {
        'code': 'function isPrime(num) { if (num <= 1) { return false; } for (var i = 2; i <= Math.sqrt(num); i++) { if (num % i === 0) { return false; } } return true; }',
        'label': 0,
    },
    {
        'code': 'var num = 7; var isPositive = num > 0;',
        'label': 0,
    },
    {
        'code': 'function isPalindrome(str) { return str === str.split("").reverse().join(""); }',
        'label': 0,
    },
    {
        'code': 'var angle = 45; var radians = angle * Math.PI / 180;',
        'label': 0,
    },
    {
        'code': 'function isLeapYear(year) { return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0; }',
        'label': 0,
    },
    {
        'code': 'var num = 15; var isMultipleOf3 = num % 3 === 0;',
        'label': 0,
    },
    {
        'code': 'function isVowel(char) { return ["a", "e", "i", "o", "u"].includes(char.toLowerCase()); }',
        'label': 0,
    },
    {
        'code': 'var temperature = 30; var isHot = temperature > 25;',
        'label': 0,
    },
    {
        'code': 'function factorial(num) { if (num === 0 || num === 1) { return 1; } else { return num * factorial(num - 1); } }',
        'label': 0,
    },
    {
        'code': 'var num = 25; var isPerfectSquare = Math.sqrt(num) === Math.floor(Math.sqrt(num));',
        'label': 0,
    },
    {
        'code': 'function isEven(num) { return num % 2 === 0; }',
        'label': 0,
    },
    {
        'code': 'var num = 12; var isDivisibleBy4 = num % 4 === 0;',
        'label': 0,
    },
    {
        'code': 'function isPositive(num) { return num > 0; }',
        'label': 0,
    },
    {
        'code': 'var length = 10; var isSquare = length * length;',
        'label': 0,
    },
    {
        'code': 'function isOdd(num) { return num % 2 !== 0; }',
        'label': 0,
    },
    {
        'code': 'var num = 30; var isMultipleOf5 = num % 5 === 0;',
        'label': 0,
    },
    {
        'code': 'function isNegative(num) { return num < 0; }',
        'label': 0,
    },
    {
        'code': 'var num = 28; var isPerfectNumber = num === 28;',
        'label': 0,
    },
    {
        'code': 'function isPowerOfTwo(num) { return num !== 0 && (num & (num - 1)) === 0; }',
        'label': 0,
    },
    {
        'code': 'function login(username, password) { if (password === "p@ssw0rd") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "jdoe" && password === "janedoe") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "12qw!@QW") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "qwe123rty456") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "user123" && password === "user1234") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "123456qwerty") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "pass@123word") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "testuser" && password === "testuser123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "qazwsx@123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "john_doe" && password === "janedoe@123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "1a2b3c4d5e6f") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "abc1234def@") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "jsmith" && password === "smithjohn") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "p@ssword123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "pass@word1234") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "user" && password === "user1234") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "!@#qwe123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "123qweASD!@#") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "test" && password === "test1234") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "qwe@123456") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "admin" && password === "password123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "!@#zxc123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "9876543210") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "!@#qaz123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "jsmith" && password === "johnsmith@123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "qazwsx!@#") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "!@#q1w2e3") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "jsmith" && password === "smithjohn123") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (password === "!@#1qaz2wsx") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function login(username, password) { if (username === "jsmith" && password === "johnsmith1234") { return true; } else { return false; } }',
        'label': 1,
    },
    {
        'code': 'function add(a, b) { return a - b; }',
        'label': 0,
    },
    {
        'code': 'function multiply(a, b) { return a * b; }',
        'label': 0,
    },
    {
        'code': 'function divide(a, b) { return a / b; }',
        'label': 0,
    },
    {
        'code': 'function square(x) { return x * x; }',
        'label': 0,
    },
    {
        'code': 'function cube(x) { return x * x * x; }',
        'label': 0,
    },
    {
        'code': 'function factorial(n) { if (n === 0 || n === 1) return 1; else return n * factorial(n - 1); }',
        'label': 0,
    },
    {
        'code': 'function isEven(n) { return n % 2 === 0; }',
        'label': 0,
    },
    {
        'code': 'function isOdd(n) { return n % 2 !== 0; }',
        'label': 0,
    },
    {
        'code': 'function isPrime(n) { if (n <= 1) return false; for (let i = 2; i <= Math.sqrt(n); i++) { if (n % i === 0) return false; } return true; }',
        'label': 0,
    },
    {
        'code': 'function fibonacci(n) { if (n === 0) return 0; else if (n === 1) return 1; else return fibonacci(n - 1) + fibonacci(n - 2); }',
        'label': 0,
    },
    {
        'code': 'function gcd(a, b) { if (b === 0) return a; else return gcd(b, a % b); }',
        'label': 0,
    },
    {
        'code': 'function lcm(a, b) { return a * b / gcd(a, b); }',
        'label': 0,
    },
    {
        'code': 'function power(base, exponent) { let result = 1; for (let i = 0; i < exponent; i++) { result *= base; } return result; }',
        'label': 0,
    },
    {
        'code': 'function reverseString(str) { return str.split("").reverse().join(""); }',
        'label': 0,
    },
    {
        'code': 'function isPalindrome(str) { return str === reverseString(str); }',
        'label': 0,
    },
    {
        'code': 'function sumArray(arr) { return arr.reduce((acc, curr) => acc + curr, 0); }',
        'label': 0,
    },
    {
        'code': 'function findMax(arr) { return Math.max(...arr); }',
        'label': 0,
    },
    {
        'code': 'function findMin(arr) { return Math.min(...arr); }',
        'label': 0,
    },
    {
        'code': 'function average(arr) { return sumArray(arr) / arr.length; }',
        'label': 0,
    },
    {
        'code': 'function isLeapYear(year) { return (year % 4 === 0 && year % 100 !== 0) || (year % 400 === 0); }',
        'label': 0,
    },
    {
        'code': 'function removeDuplicates(arr) { return arr.filter((value, index, self) => self.indexOf(value) === index); }',
        'label': 0,
    },
    {
        'code': 'function titleCase(str) { return str.split(" ").map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(" "); }',
        'label': 0,
    },
    {
        'code': 'function isAnagram(str1, str2) { return sortString(str1) === sortString(str2); } function sortString(str) { return str.split("").sort().join(""); }',
        'label': 0,
    },
    {
        'code': 'function countVowels(str) { const vowels = "aeiouAEIOU"; return str.split("").filter(char => vowels.includes(char)).length; }',
        'label': 0,
    },
    {
        'code': 'function countConsonants(str) { const consonants = "bcdfghjklmnpqrstvwxyzBCDFGHJKLMNPQRSTVWXYZ"; return str.split("").filter(char => consonants.includes(char)).length; }',
        'label': 0,
    },
    {
        'code': 'function reverseArray(arr) { return arr.reverse(); }',
        'label': 0,
    },
    {
        'code': 'function capitalizeFirstLetter(str) { return str.charAt(0).toUpperCase() + str.slice(1); }',
        'label': 0,
    },
    {
        'code': 'function truncateString(str, maxLength) { return str.length > maxLength ? str.slice(0, maxLength) + "..." : str; }',
        'label': 0,
    },
    {
        'code': 'function countWords(str) { return str.split(" ").filter(word => word !== "").length; }',
        'label': 0,
    },
    {
        'code': 'function isEmailValid(email) { const pattern = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/; return pattern.test(email); }',
        'label': 0,
    },
    {
        'code': 'function isURLValid(url) { const pattern = /^(https?:\\/\\/)?([\\w.-]+)\\.([a-z]{2,})(\\/?[\\w .-])\\/?$/; return pattern.test(url); }',
        'label': 0,
    },
    {
        'code': 'function countOccurrences(arr, target) { return arr.filter(item => item === target).length; }',
        'label': 0,
    },
    {
        'code': 'function formatCurrency(amount) { return "$" + amount.toFixed(2); }',
        'label': 0,
    },
    {
        'code': 'function randomInteger(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }',
        'label': 0,
    },
    {
        'code': 'function reverseWords(str) { return str.split(" ").reverse().join(" "); }',
        'label': 0,
    },
    {
        'code': 'function isPrime(n) { if (n <= 1) return false; for (let i = 2; i <= Math.sqrt(n); i++) { if (n % i === 0) return false; } return true; }',
        'label': 0,
    },
];
// Prepare the data for training
const code_samples = dataset.map((sample) => sample.code);
const labels = dataset.map((sample) => sample.label);
// Create a tokenizer
const tokenizer = new natural_1.WordTokenizer();
// Vectorize the code samples using the tokenizer
const tokenizedSamples = code_samples
    .map((code) => tokenizer.tokenize(code))
    .filter((tokens) => tokens !== null);
// Train a Naive Bayes classifier
const classifier = new natural_1.BayesClassifier();
for (let i = 0; i < tokenizedSamples.length; i++) {
    classifier.addDocument(tokenizedSamples[i], labels[i].toString());
}
classifier.train();
// Function to detect vulnerability brute force attack in a new code snippet
function detectBruteForce(code_snippet) {
    const codeArray = code_snippet.split('\n');
    let detect = false;
    for (let index = 0; index < codeArray.length; index++) {
        // Vectorize the new code snippet
        const tokenizedSnippet = tokenizer.tokenize(codeArray[index]);
        // Make prediction using the trained classifier
        if (tokenizedSnippet !== null) {
            const prediction = classifier.classify(tokenizedSnippet);
            const result = parseInt(prediction);
            if (result && codeArray[index].length > 0) {
                detect = true;
                const result = "==> Code vulnerable to Brute force Attack : " + codeArray[index];
                console.log(result.red);
            }
        }
        else {
            // Handle the case where tokenization failed (if necessary)
            // For simplicity, I'm returning -1 here, but you can decide how to handle it.
        }
    }
    if (!detect) {
        console.log("==> Code NOT vulnerable to Brute force Attack : ".green);
    }
}
exports.detectBruteForce = detectBruteForce;
