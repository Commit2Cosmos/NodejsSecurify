import * as fs from 'fs';
import * as esprima from 'esprima';
import * as esquery from 'esquery';

export default function detectBruteForce(jsFilePath: string): void {
    const fileContent = fs.readFileSync(jsFilePath, 'utf8');
    const parsedAST = esprima.parseScript(fileContent, { loc: true });

    const bruteForceQuery = `FunctionDeclaration > BlockStatement > ForStatement`;

    const bruteForceNodes = esquery(parsedAST, bruteForceQuery);

    bruteForceNodes.forEach((node: { loc: any; parent: any; }) => {
        const { line, column } = node.loc!.start;
        const functionName = node.parent!.id!.name;

        console.log(`Potential brute-force detected in function "${functionName}" at line ${line}, column ${column}`);
    });
}

const jsFileJSONPath = '/path/to/your/file.json';
detectBruteForce(jsFileJSONPath);